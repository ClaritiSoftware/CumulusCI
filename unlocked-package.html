<!doctype html>
<html class="no-js" lang="en" data-content_root="./">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="author" title="About these documents" href="about.html" /><link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="Extend NPSP and EDA with Second-Generation Packaging" href="npsp-eda-2gp.html" /><link rel="prev" title="Release a Second-Generation Managed Package" href="managed-2gp.html" />

    <!-- Generated with Sphinx 8.2.3 and Furo 2025.07.19 -->
        <title>Release an Unlocked Package - CumulusCI 4.6.0.dev1 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?v=25af2a20" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?v=8dab3a3b" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #2b2b2b;
  --color-code-foreground: #f8f8f2;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #2b2b2b;
  --color-code-foreground: #f8f8f2;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">CumulusCI 4.6.0.dev1 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  <span class="sidebar-brand-text">CumulusCI 4.6.0.dev1 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="concepts.html">Key Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="get-started.html">Get Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="cli.html">The <code class="docutils literal notranslate"><span class="pre">cci</span></code> Command Line</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="config.html">Configure CumulusCI</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Configure CumulusCI</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="deploy.html">Configure Metadata Deployment</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="scratch-orgs.html">Manage Scratch Orgs</a></li>
<li class="toctree-l1"><a class="reference internal" href="connected-orgs.html">Connect Persistent Orgs</a></li>
<li class="toctree-l1"><a class="reference internal" href="dev.html">Develop a Project</a></li>
<li class="toctree-l1"><a class="reference internal" href="data.html">Automate Data Operations</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="robot.html">Acceptance Testing with Robot Framework</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Acceptance Testing with Robot Framework</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="robot-locators.html">Managing Locators</a></li>
<li class="toctree-l2"><a class="reference internal" href="robot-advanced.html">Robot Advanced Topics</a></li>
<li class="toctree-l2"><a class="reference internal" href="robot-tutorial.html">Robot Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="robot-debugger.html">Robot Debugger</a></li>
<li class="toctree-l2"><a class="reference internal" href="robot-playwright.html">Playwright Technology Preview</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="continuous-integration.html">Continuous Integration</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Continuous Integration</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="cumulusci-flow.html">CumulusCI Flow</a></li>
<li class="toctree-l2"><a class="reference internal" href="github-actions.html">Run CumulusCI from GitHub Actions</a></li>
<li class="toctree-l2"><a class="reference internal" href="2gp-testing.html">Testing with Second-Generation Packaging</a></li>
<li class="toctree-l2"><a class="reference internal" href="headless.html">Run CumulusCI Headlessly</a></li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="packaging.html">Release Managed and Unlocked Packages</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of Release Managed and Unlocked Packages</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="managed-package.html">Release a First-Generation Managed Package</a></li>
<li class="toctree-l2"><a class="reference internal" href="managed-2gp.html">Release a Second-Generation Managed Package</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Release an Unlocked Package</a></li>
<li class="toctree-l2"><a class="reference internal" href="npsp-eda-2gp.html">Extend NPSP and EDA with Second-Generation Packaging</a></li>
<li class="toctree-l2"><a class="reference internal" href="release-notes.html">Generate Release Notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="push-upgrades.html">Manage Push Upgrades</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="unpackaged.html">Manage Unpackaged Configuration</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of Manage Unpackaged Configuration</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="metadata-etl.html">Metadata ETL</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="reference.html">Reference</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of Reference</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="cheat-sheet.html">Cheat Sheet</a></li>
<li class="toctree-l2"><a class="reference internal" href="flows.html">Flow Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="env-var-reference.html">Environment Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="org_config-reference.html">org_config Object Reference</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="about.html">About CumulusCI</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of About CumulusCI</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="contributing.html">Contribute to CumulusCI</a></li>
<li class="toctree-l2"><a class="reference internal" href="history.html">History</a></li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="_sources/unlocked-package.md.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="release-an-unlocked-package">
<h1>Release an Unlocked Package<a class="headerlink" href="#release-an-unlocked-package" title="Link to this heading">¶</a></h1>
<p>While CumulusCI was originally created to develop managed packages, it
can also be used to develop and release <a class="reference external" href="https://developer.salesforce.com/docs/atlas.en-us.sfdx_dev.meta/sfdx_dev/sfdx_dev_unlocked_pkg_intro.htm">unlocked
packages</a>.</p>
<section id="prerequisites">
<h2>Prerequisites<a class="headerlink" href="#prerequisites" title="Link to this heading">¶</a></h2>
<p>This section assumes:</p>
<ul class="simple">
<li><p><a class="reference internal" href="get-started.html"><span class="doc std std-doc">CumulusCI is installed</span></a> on your computer.</p></li>
<li><p>A Salesforce managed package project has been <a class="reference internal" href="get-started.html#project-initialization"><span class="std std-ref">configured</span></a>
for use with CumulusCI.</p></li>
<li><p>Your Dev Hub has the required features enabled: <a class="reference external" href="https://developer.salesforce.com/docs/atlas.en-us.packagingGuide.meta/packagingGuide/sfdx_setup_enable_devhub.htm">Enable DevHub
Features in Your
Org</a>
and <a class="reference external" href="https://developer.salesforce.com/docs/atlas.en-us.sfdx_dev.meta/sfdx_dev/sfdx_setup_enable_secondgen_pkg.htm">Enable Unlocked and Second-Generation Managed
Packaging</a>.</p></li>
<li><p>If you’re building a namespaced unlocked package, a namespace org
has been <a class="reference external" href="https://developer.salesforce.com/docs/atlas.en-us.sfdx_dev.meta/sfdx_dev/sfdx_dev_dev2gp_create_namespace.htm">created and linked to the active Dev
Hub</a>.</p></li>
</ul>
</section>
<section id="create-a-beta-version">
<h2>Create a Beta Version<a class="headerlink" href="#create-a-beta-version" title="Link to this heading">¶</a></h2>
<p>CumulusCI uses the <code class="docutils literal notranslate"><span class="pre">dependencies</span></code> section of your <code class="docutils literal notranslate"><span class="pre">cumulusci.yml</span></code> file
to define your 2GP project’s dependencies. CumulusCI uses GitHub
releases to identify the ancestor Id and new version number for the beta
package version. By default, the new beta version will increment the
minor version number from the most recent GitHub release.</p>
<p>Because Salesforce requires package version Ids (<code class="docutils literal notranslate"><span class="pre">04txxxxxxxxxxxx</span></code>) for
2GP package dependencies, some CumulusCI dependencies must be installed
in an org to make those Ids available. If your project has dependencies
that are not specified as a <code class="docutils literal notranslate"><span class="pre">version_id</span></code>, start by running</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>cci<span class="w"> </span>flow<span class="w"> </span>run<span class="w"> </span>dependencies<span class="w"> </span>--org<span class="w"> </span>dev
</pre></div>
</div>
<p>When you’re ready, and your org is prepared, to upload a package
version, run the command</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>cci<span class="w"> </span>flow<span class="w"> </span>run<span class="w"> </span>release_unlocked_beta<span class="w"> </span>--org<span class="w"> </span>dev
</pre></div>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>The org supplied to <code class="docutils literal notranslate"><span class="pre">release_unlocked_beta</span></code> has two purposes. One is to
look up the Ids of dependency packages (see above). The other is to
provide the configuration for the <em>build org</em> used to upload the 2GP
package version. CumulusCI will use the scratch org definition file used
to create the specified org (<code class="docutils literal notranslate"><span class="pre">dev</span></code> here) to create the build org, which
defines the features and settings available during package upload.</p>
<p>You may wish to define a separate scratch org configuration (<code class="docutils literal notranslate"><span class="pre">build</span></code>)
just for package uploads to ensure only your required features are
present.</p>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">release_unlocked_beta</span></code> flow executes these tasks:</p>
<ul class="simple">
<li><p>Uploads a new beta version of the unlocked package.</p></li>
<li><p>Creates a new GitHub release tag for the new beta version. Extension
packages that also use CumulusCI require this release tag to find
the latest version when this repository is listed as a dependency.</p></li>
<li><p><a class="reference internal" href="tasks.html#github-release-notes"><span class="std std-ref">Generates Release Notes</span></a>.</p></li>
<li><p>Syncs feature branches with the <code class="docutils literal notranslate"><span class="pre">main</span></code> branch, which automatically
integrates the latest changes from <code class="docutils literal notranslate"><span class="pre">main</span></code>. For more information see
<a class="reference internal" href="cumulusci-flow.html#auto-merging"><span class="std std-ref">Auto Merging</span></a>.</p></li>
</ul>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>To list each step in the <code class="docutils literal notranslate"><span class="pre">release_unlocked_beta</span></code> flow, run
<code class="docutils literal notranslate"><span class="pre">cci</span> <span class="pre">flow</span> <span class="pre">info</span> <span class="pre">release_unlocked_beta</span></code>.</p>
</div>
<section id="customizing-package-uploads">
<h3>Customizing Package Uploads<a class="headerlink" href="#customizing-package-uploads" title="Link to this heading">¶</a></h3>
<p>2GP package uploads are performed by the <code class="docutils literal notranslate"><span class="pre">create_package_version</span></code> task.
If the built-in configuration used by <code class="docutils literal notranslate"><span class="pre">release_unlocked_beta</span></code> does not
suit the needs of your project - for example, if you want to increment
version numbers differently, or build an org-dependent package - you can
customize the options for that task in <code class="docutils literal notranslate"><span class="pre">release_unlocked_beta</span></code> or invoke
the task directly.</p>
<p>To learn more about the available options, run</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>cci<span class="w"> </span>task<span class="w"> </span>info<span class="w"> </span>create_package_version
</pre></div>
</div>
<p>CumulusCI can also create org-dependent and skip-validation packages
when configured with the appropriate options.</p>
</section>
<section id="handling-unpackaged-metadata">
<h3>Handling Unpackaged Metadata<a class="headerlink" href="#handling-unpackaged-metadata" title="Link to this heading">¶</a></h3>
<p>CumulusCI projects can include <em>unpackaged metadata</em> in directories like
<code class="docutils literal notranslate"><span class="pre">unpackaged/pre</span></code> and <code class="docutils literal notranslate"><span class="pre">unpackaged/post</span></code>. These directories are deployed
when CumulusCI creates a scratch org, and are installed in the packaging
org when CumulusCI creates 1GP package versions.However,
second-generation packaging does not have a packaging org, and does not
allow interactive access to the build org.</p>
<p>CumulusCI offers two modes of handling unpackaged metadata owned by
dependencies when building a second-generation package.</p>
<p>The default behavior is to ignore unpackaged metadata. If unpackaged
metadata is intended to satisfy install-time dependencies of packages,
this requires that those dependencies be met in other ways, such as by
configuring the scratch org definition. For examples of how to satisfy
the install-time dependencies for NPSP and EDA without using unpackaged
metadata, see <a class="reference internal" href="npsp-eda-2gp.html"><span class="doc std std-doc">Extend NPSP and EDA with Second-Generation Packaging</span></a>.</p>
<p>The other option is to have CumulusCI automatically create unlocked
packages containing unpackaged metadata from dependency projects. For
example, if your project depended on the repository <code class="docutils literal notranslate"><span class="pre">Food-Bank</span></code>, which
contained the unpackaged metadata directories</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">unpackaged/pre/record_types</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">unpackaged/pre/setup</span></code></p></li>
</ul>
<p>CumulusCI would automatically, while uploading a version of your
package, upload unlocked package versions containing the current content
of those unpackaged directories.</p>
<p>The unlocked package route is generally suitable for testing only, where
it may be convenient when working with complex legacy projects that
include lots of unpackaged metadata. However, it’s generally <em>not</em>
suitable for use when building production packages, because your
packages would have to be distributed along with those unlocked
packages. For this reason, this behavior is off by default. If you would
like to use it, configure your <code class="docutils literal notranslate"><span class="pre">cumulusci.yml</span></code> to set the option
<code class="docutils literal notranslate"><span class="pre">create_unlocked_dependency_packages</span></code> on the <code class="docutils literal notranslate"><span class="pre">create_package_version</span></code>
task.</p>
</section>
</section>
<section id="test-a-beta-version">
<h2>Test a Beta Version<a class="headerlink" href="#test-a-beta-version" title="Link to this heading">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">ci_beta</span></code> flow installs the latest beta version of the project in a
scratch org, and runs Apex tests against it.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>cci<span class="w"> </span>flow<span class="w"> </span>run<span class="w"> </span>ci_beta<span class="w"> </span>--org<span class="w"> </span>beta
</pre></div>
</div>
<p>This flow is intended to be run whenever a beta release is created.</p>
</section>
<section id="promote-a-production-version">
<h2>Promote a Production Version<a class="headerlink" href="#promote-a-production-version" title="Link to this heading">¶</a></h2>
<p>To be installed in a production org, an 2GP package version must be
<a class="reference external" href="https://developer.salesforce.com/docs/atlas.en-us.sfdx_dev.meta/sfdx_dev/sfdx_dev_unlocked_pkg_create_pkg_ver_promote.htm">promoted</a>
to mark it as released.</p>
<p>To promote a production release of your managed package project:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ cci flow run release_unlocked_production --org packaging
</pre></div>
</div>
<p>Unlike first-generation packages, promoting a second-generation package
doesn’t upload a new version. Instead, it promotes the most recent beta
version (found in the project’s GitHub releases) to production status.
Then, CumulusCI creates a new, production GitHub release, and aggregates
release notes for that release.</p>
<p>You can also promote a package using its <code class="docutils literal notranslate"><span class="pre">04t</span></code> package Id, without using
the GitHub release operations:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>cci<span class="w"> </span>task<span class="w"> </span>run<span class="w"> </span>promote_package_version<span class="w"> </span>--version_id<span class="w"> </span>04t000000000000<span class="w"> </span>--promote_dependencies<span class="w"> </span>True
</pre></div>
</div>
<p>Alternatively, you can use the <code class="docutils literal notranslate"><span class="pre">sf</span> <span class="pre">package</span> <span class="pre">version</span> <span class="pre">promote</span></code>
command to promote a 2GP package.</p>
<section id="promote-dependencies">
<h3>Promote Dependencies<a class="headerlink" href="#promote-dependencies" title="Link to this heading">¶</a></h3>
<p>If additional unlocked packages were created to hold unpackaged
dependencies, they must be promoted as well. To promote dependencies
automatically use <code class="docutils literal notranslate"><span class="pre">--promote_dependencies</span> <span class="pre">True</span></code> with the
<code class="docutils literal notranslate"><span class="pre">promote_package_version</span></code> task, or customize the
<code class="docutils literal notranslate"><span class="pre">release_unlocked_production</span></code> flow to include that option.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>cci<span class="w"> </span>task<span class="w"> </span>run<span class="w"> </span>promote_package_version<span class="w"> </span>--version_id<span class="w"> </span>04t000000000000<span class="w"> </span>--promote_dependencies<span class="w"> </span>True
</pre></div>
</div>
<p>Test a Production Version ——————-</p>
<p>To test the new package version:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ cci flow run ci_release --org release
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">ci_release</span></code> flow installs the latest production release version and
runs the Apex tests from the managed package on a scratch org.</p>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="npsp-eda-2gp.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Extend NPSP and EDA with Second-Generation Packaging</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="managed-2gp.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Release a Second-Generation Managed Package</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2022, Salesforce.org
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Release an Unlocked Package</a><ul>
<li><a class="reference internal" href="#prerequisites">Prerequisites</a></li>
<li><a class="reference internal" href="#create-a-beta-version">Create a Beta Version</a><ul>
<li><a class="reference internal" href="#customizing-package-uploads">Customizing Package Uploads</a></li>
<li><a class="reference internal" href="#handling-unpackaged-metadata">Handling Unpackaged Metadata</a></li>
</ul>
</li>
<li><a class="reference internal" href="#test-a-beta-version">Test a Beta Version</a></li>
<li><a class="reference internal" href="#promote-a-production-version">Promote a Production Version</a><ul>
<li><a class="reference internal" href="#promote-dependencies">Promote Dependencies</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="_static/documentation_options.js?v=dac0bbfe"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/furo.js?v=46bd48cc"></script>
    </body>
</html>